{
    "openapi": "3.0.1",
    "info": {
        "title": "Azure Firewall Management API",
        "version": "2024-03-01",
        "description": "API for managing Azure Firewalls in a specified subscription and resource group."
    },
    "servers": [
        {
            "url": "https://management.azure.com",
            "description": "Azure Management Base URL"
        }
    ],
    "paths": {
        "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/azureFirewalls/{azureFirewallName}": {
            "get": {
                "summary": "Get Azure Firewall",
                "description": "Retrieve details of a specified Azure Firewall within a subscription and resource group.",
                "operationId": "Intune_GetAzureFirewall",
                "parameters": [
                    {
                        "name": "azureFirewallName",
                        "in": "path",
                        "description": "The name of the Azure Firewall.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {}
                        }
                    },
                    {
                        "name": "resourceGroupName",
                        "in": "path",
                        "description": "The name of the resource group.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "subscriptionId",
                        "in": "path",
                        "description": "The subscription credentials which uniquely identify the Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Client API version.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "default": "2024-03-01",
                            "enum": [ "2024-03-01" ],
                            "x-enumDescriptions": {
                                "2024-03-01": "The API version for March 2024."
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Request successful. The operation returns an AzureFirewall resource.",
                        "content": {
                            "application/json": {
                                "type": "object",
                                "schema": {
                                    "$ref": "#/components/schemas/AzureFirewall"
                                },
                                "examples": [
                                    {
                                        "summary": "Tell me about the Firewall fw in Resource Group rg and Subscription subId",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {},
                                                    "autoscaleConfiguration": {
                                                        "minCapacity": 10,
                                                        "maxCapacity": 15
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What location is this Firewall deployed in?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {},
                                                    "autoscaleConfiguration": {
                                                        "minCapacity": 10,
                                                        "maxCapacity": 15
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Is the Firewall configured for multiple availability zones? If so, how many?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US 2",
                                                "zones": [
                                                    "1",
                                                    "2",
                                                    "3"
                                                ],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {}
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What are the tags on this Firewall instance?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {},
                                                    "autoscaleConfiguration": {
                                                        "minCapacity": 10,
                                                        "maxCapacity": 15
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What SKU Firewall is this?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {},
                                                    "autoscaleConfiguration": {
                                                        "minCapacity": 10,
                                                        "maxCapacity": 15
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Is the Firewall successfully provisioned?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {},
                                                    "autoscaleConfiguration": {
                                                        "minCapacity": 10,
                                                        "maxCapacity": 15
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Is threat intel enabled on this Firewall?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [],
                                                    "additionalProperties": {},
                                                    "autoscaleConfiguration": {
                                                        "minCapacity": 10,
                                                        "maxCapacity": 15
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What is the private IP of the Firewall?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups1"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups1"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups2"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups3"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [
                                                        {
                                                            "id": "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups1",
                                                            "changeNumber": "5"
                                                        },
                                                        {
                                                            "id": "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups2",
                                                            "changeNumber": "4"
                                                        },
                                                        {
                                                            "id": "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups3",
                                                            "changeNumber": "1"
                                                        }
                                                    ],
                                                    "additionalProperties": {}
                                                }
                                            }

                                        }
                                    },
                                    {
                                        "summary": "Does the Firewall have a public IP?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups1"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups1"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups2"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceIpGroups": [
                                                                            "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups3"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "ipGroups": [
                                                        {
                                                            "id": "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups1",
                                                            "changeNumber": "5"
                                                        },
                                                        {
                                                            "id": "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups2",
                                                            "changeNumber": "4"
                                                        },
                                                        {
                                                            "id": "/subscriptions/subId/providers/Microsoft.Network/resourceGroup/myResourceGroup/ipGroups/ipGroups3",
                                                            "changeNumber": "1"
                                                        }
                                                    ],
                                                    "additionalProperties": {}
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What subnet is the Firewall provisioned in?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "managementIpConfiguration": {
                                                        "name": "azureFirewallMgmtIpConfiguration",
                                                        "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallMgmtIpConfiguration",
                                                        "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                        "properties": {
                                                            "provisioningState": "Succeeded",
                                                            "subnet": {
                                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallManagementSubnet"
                                                            },
                                                            "publicIPAddress": {
                                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/managementPipName"
                                                            }
                                                        }
                                                    },
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "additionalProperties": {}
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Are there any additional properties configured?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "additionalProperties": {
                                                        "key1": "value1",
                                                        "key2": "value2"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Does the Firewall have a Management NIC/IP configured?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall?api-version=2024-03-01",
                                            "response": {
                                                "name": "azurefirewall",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall",
                                                "type": "Microsoft.Network/azureFirewalls",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "zones": [],
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "sku": {
                                                        "name": "AZFW_VNet",
                                                        "tier": "Standard"
                                                    },
                                                    "threatIntelMode": "Alert",
                                                    "ipConfigurations": [
                                                        {
                                                            "name": "azureFirewallIpConfiguration",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallIpConfiguration",
                                                            "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                            "properties": {
                                                                "provisioningState": "Succeeded",
                                                                "privateIPAddress": "10.0.0.0",
                                                                "subnet": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallSubnet"
                                                                },
                                                                "publicIPAddress": {
                                                                    "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/pipName"
                                                                }
                                                            }
                                                        }
                                                    ],
                                                    "managementIpConfiguration": {
                                                        "name": "azureFirewallMgmtIpConfiguration",
                                                        "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/ipConfigurations/azureFirewallMgmtIpConfiguration",
                                                        "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                        "properties": {
                                                            "provisioningState": "Succeeded",
                                                            "subnet": {
                                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/vnet2/subnets/AzureFirewallManagementSubnet"
                                                            },
                                                            "publicIPAddress": {
                                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/publicIPAddresses/managementPipName"
                                                            }
                                                        }
                                                    },
                                                    "applicationRuleCollections": [
                                                        {
                                                            "name": "apprulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/applicationRuleCollections/apprulecoll",
                                                            "properties": {
                                                                "priority": 110,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "rule1",
                                                                        "description": "Deny inbound rule",
                                                                        "protocols": [
                                                                            {
                                                                                "protocolType": "Https",
                                                                                "port": 443
                                                                            }
                                                                        ],
                                                                        "targetFqdns": [
                                                                            "www.test.com"
                                                                        ],
                                                                        "sourceAddresses": [
                                                                            "216.58.216.164",
                                                                            "10.0.0.0/24"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "natRuleCollections": [
                                                        {
                                                            "name": "natrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/natRuleCollections/natrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Dnat"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "DNAT-HTTPS-traffic",
                                                                        "description": "D-NAT all outbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedAddress": "1.2.3.5",
                                                                        "translatedPort": "8443"
                                                                    },
                                                                    {
                                                                        "name": "DNAT-HTTP-traffic-With-FQDN",
                                                                        "description": "D-NAT all inbound web traffic for inspection",
                                                                        "sourceAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "1.2.3.4"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "80"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ],
                                                                        "translatedFqdn": "internalhttpserver",
                                                                        "translatedPort": "880"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "networkRuleCollections": [
                                                        {
                                                            "name": "netrulecoll",
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/azureFirewalls/azurefirewall/networkRuleCollections/netrulecoll",
                                                            "properties": {
                                                                "priority": 112,
                                                                "action": {
                                                                    "type": "Deny"
                                                                },
                                                                "rules": [
                                                                    {
                                                                        "name": "L4-traffic",
                                                                        "description": "Block traffic based on source IPs and ports",
                                                                        "sourceAddresses": [
                                                                            "192.168.1.1-192.168.1.12",
                                                                            "10.1.4.12-10.1.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationAddresses": [
                                                                            "*"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    },
                                                                    {
                                                                        "name": "L4-traffic-with-FQDN",
                                                                        "description": "Block traffic based on source IPs and ports to amazon",
                                                                        "sourceAddresses": [
                                                                            "10.2.4.12-10.2.4.255"
                                                                        ],
                                                                        "destinationPorts": [
                                                                            "443-444",
                                                                            "8443"
                                                                        ],
                                                                        "destinationFqdns": [
                                                                            "www.amazon.com"
                                                                        ],
                                                                        "protocols": [
                                                                            "TCP"
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ],
                                                    "additionalProperties": {}
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    "default": {
                        "description": "Error response describing why the operation failed.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CloudError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "azure_auth": [
                            "https://management.azure.com/user_impersonation"
                        ]
                    }
                ]
            }
        },
        "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/firewallPolicies/{firewallPolicyName}": {
            "get": {
                "summary": "Get Firewall Policy",
                "description": "Retrieve details of a specified Firewall Policy within a subscription and resource group.",
                "operationId": "Intune_GetFirewallPolicy",
                "parameters": [
                    {
                        "name": "firewallPolicyName",
                        "in": "path",
                        "description": "The name of the Firewall Policy.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "resourceGroupName",
                        "in": "path",
                        "description": "The name of the resource group.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "subscriptionId",
                        "in": "path",
                        "description": "The subscription credentials which uniquely identify the Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Client API version.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [ "2024-03-01" ],
                            "x-enumDescriptions": {
                                "2024-03-01": "The API version for March 2024."
                            }
                        }
                    },
                    {
                        "name": "$expand",
                        "in": "query",
                        "description": "Comma-separated list of properties to expand in the response.",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Request successful. The operation returns a FirewallPolicy resource.",
                        "content": {
                            "application/json": {
                                "type": "object",
                                "schema": {
                                    "$ref": "#/components/schemas/FirewallPolicy"
                                },
                                "examples": [
                                    {
                                        "summary": "Give me details about the firewall policy fwpolicy in resource group rg and subscription subId",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy?api-version=2024-03-01",
                                            "response": {
                                                "name": "firewallPolicy",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
                                                "type": "Microsoft.Network/firewallPolicies",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "size": "0.5MB",
                                                    "provisioningState": "Succeeded",
                                                    "threatIntelMode": "Alert",
                                                    "threatIntelWhitelist": {
                                                        "ipAddresses": [
                                                            "20.3.4.5"
                                                        ],
                                                        "fqdns": [
                                                            "*.microsoft.com"
                                                        ]
                                                    },
                                                    "ruleCollectionGroups": [
                                                        {
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
                                                        }
                                                    ],
                                                    "insights": {
                                                        "isEnabled": true,
                                                        "retentionDays": 100,
                                                        "logAnalyticsResources": {
                                                            "workspaces": [
                                                                {
                                                                    "region": "westus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace1"
                                                                    }
                                                                },
                                                                {
                                                                    "region": "eastus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace2"
                                                                    }
                                                                }
                                                            ],
                                                            "defaultWorkspaceId": {
                                                                "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/defaultWorkspace"
                                                            }
                                                        }
                                                    },
                                                    "firewalls": [],
                                                    "snat": {
                                                        "privateRanges": [
                                                            "IANAPrivateRanges"
                                                        ]
                                                    },
                                                    "sql": {
                                                        "allowSqlRedirect": true
                                                    },
                                                    "dnsSettings": {
                                                        "servers": [
                                                            "30.3.4.5"
                                                        ],
                                                        "enableProxy": true,
                                                        "requireProxyForNetworkRules": false
                                                    },
                                                    "explicitProxy": {
                                                        "enableExplicitProxy": true,
                                                        "httpPort": 8087,
                                                        "httpsPort": 8087,
                                                        "enablePacFile": true,
                                                        "pacFilePort": 8087,
                                                        "pacFile": "https://tinawstorage.file.core.windows.net/?sv=2020-02-10&ss=bfqt&srt=sco&sp=rwdlacuptfx&se=2021-06-04T07:01:12Z&st=2021-06-03T23:01:12Z&sip=68.65.171.11&spr=https&sig=Plsa0RRVpGbY0IETZZOT6znOHcSro71LLTTbzquYPgs%3D"
                                                    },
                                                    "sku": {
                                                        "tier": "Premium"
                                                    },
                                                    "intrusionDetection": {
                                                        "mode": "Alert",
                                                        "configuration": {
                                                            "signatureOverrides": [
                                                                {
                                                                    "id": "2525004",
                                                                    "mode": "Deny"
                                                                }
                                                            ],
                                                            "bypassTrafficSettings": [
                                                                {
                                                                    "name": "bypassRule1",
                                                                    "description": "Rule 1",
                                                                    "protocol": "TCP",
                                                                    "sourceAddresses": [
                                                                        "1.2.3.4"
                                                                    ],
                                                                    "destinationAddresses": [
                                                                        "5.6.7.8"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "transportSecurity": {
                                                        "certificateAuthority": {
                                                            "name": "clientcert",
                                                            "keyVaultSecretId": "https://kv/secret"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What is the threat intel white list on this policy?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy?api-version=2024-03-01",
                                            "response": {
                                                "name": "firewallPolicy",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
                                                "type": "Microsoft.Network/firewallPolicies",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "size": "0.5MB",
                                                    "provisioningState": "Succeeded",
                                                    "threatIntelMode": "Alert",
                                                    "threatIntelWhitelist": {
                                                        "ipAddresses": [
                                                            "20.3.4.5"
                                                        ],
                                                        "fqdns": [
                                                            "*.microsoft.com"
                                                        ]
                                                    },
                                                    "ruleCollectionGroups": [
                                                        {
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
                                                        }
                                                    ],
                                                    "insights": {
                                                        "isEnabled": true,
                                                        "retentionDays": 100,
                                                        "logAnalyticsResources": {
                                                            "workspaces": [
                                                                {
                                                                    "region": "westus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace1"
                                                                    }
                                                                },
                                                                {
                                                                    "region": "eastus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace2"
                                                                    }
                                                                }
                                                            ],
                                                            "defaultWorkspaceId": {
                                                                "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/defaultWorkspace"
                                                            }
                                                        }
                                                    },
                                                    "firewalls": [],
                                                    "snat": {
                                                        "privateRanges": [
                                                            "IANAPrivateRanges"
                                                        ]
                                                    },
                                                    "sql": {
                                                        "allowSqlRedirect": true
                                                    },
                                                    "dnsSettings": {
                                                        "servers": [
                                                            "30.3.4.5"
                                                        ],
                                                        "enableProxy": true,
                                                        "requireProxyForNetworkRules": false
                                                    },
                                                    "explicitProxy": {
                                                        "enableExplicitProxy": true,
                                                        "httpPort": 8087,
                                                        "httpsPort": 8087,
                                                        "enablePacFile": true,
                                                        "pacFilePort": 8087,
                                                        "pacFile": "https://tinawstorage.file.core.windows.net/?sv=2020-02-10&ss=bfqt&srt=sco&sp=rwdlacuptfx&se=2021-06-04T07:01:12Z&st=2021-06-03T23:01:12Z&sip=68.65.171.11&spr=https&sig=Plsa0RRVpGbY0IETZZOT6znOHcSro71LLTTbzquYPgs%3D"
                                                    },
                                                    "sku": {
                                                        "tier": "Premium"
                                                    },
                                                    "intrusionDetection": {
                                                        "mode": "Alert",
                                                        "configuration": {
                                                            "signatureOverrides": [
                                                                {
                                                                    "id": "2525004",
                                                                    "mode": "Deny"
                                                                }
                                                            ],
                                                            "bypassTrafficSettings": [
                                                                {
                                                                    "name": "bypassRule1",
                                                                    "description": "Rule 1",
                                                                    "protocol": "TCP",
                                                                    "sourceAddresses": [
                                                                        "1.2.3.4"
                                                                    ],
                                                                    "destinationAddresses": [
                                                                        "5.6.7.8"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "transportSecurity": {
                                                        "certificateAuthority": {
                                                            "name": "clientcert",
                                                            "keyVaultSecretId": "https://kv/secret"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Are logs configured for this policy?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy?api-version=2024-03-01",
                                            "response": {
                                                "name": "firewallPolicy",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
                                                "type": "Microsoft.Network/firewallPolicies",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "size": "0.5MB",
                                                    "provisioningState": "Succeeded",
                                                    "threatIntelMode": "Alert",
                                                    "threatIntelWhitelist": {
                                                        "ipAddresses": [
                                                            "20.3.4.5"
                                                        ],
                                                        "fqdns": [
                                                            "*.microsoft.com"
                                                        ]
                                                    },
                                                    "ruleCollectionGroups": [
                                                        {
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
                                                        }
                                                    ],
                                                    "insights": {
                                                        "isEnabled": true,
                                                        "retentionDays": 100,
                                                        "logAnalyticsResources": {
                                                            "workspaces": [
                                                                {
                                                                    "region": "westus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace1"
                                                                    }
                                                                },
                                                                {
                                                                    "region": "eastus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace2"
                                                                    }
                                                                }
                                                            ],
                                                            "defaultWorkspaceId": {
                                                                "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/defaultWorkspace"
                                                            }
                                                        }
                                                    },
                                                    "firewalls": [],
                                                    "snat": {
                                                        "privateRanges": [
                                                            "IANAPrivateRanges"
                                                        ]
                                                    },
                                                    "sql": {
                                                        "allowSqlRedirect": true
                                                    },
                                                    "dnsSettings": {
                                                        "servers": [
                                                            "30.3.4.5"
                                                        ],
                                                        "enableProxy": true,
                                                        "requireProxyForNetworkRules": false
                                                    },
                                                    "explicitProxy": {
                                                        "enableExplicitProxy": true,
                                                        "httpPort": 8087,
                                                        "httpsPort": 8087,
                                                        "enablePacFile": true,
                                                        "pacFilePort": 8087,
                                                        "pacFile": "https://tinawstorage.file.core.windows.net/?sv=2020-02-10&ss=bfqt&srt=sco&sp=rwdlacuptfx&se=2021-06-04T07:01:12Z&st=2021-06-03T23:01:12Z&sip=68.65.171.11&spr=https&sig=Plsa0RRVpGbY0IETZZOT6znOHcSro71LLTTbzquYPgs%3D"
                                                    },
                                                    "sku": {
                                                        "tier": "Premium"
                                                    },
                                                    "intrusionDetection": {
                                                        "mode": "Alert",
                                                        "configuration": {
                                                            "signatureOverrides": [
                                                                {
                                                                    "id": "2525004",
                                                                    "mode": "Deny"
                                                                }
                                                            ],
                                                            "bypassTrafficSettings": [
                                                                {
                                                                    "name": "bypassRule1",
                                                                    "description": "Rule 1",
                                                                    "protocol": "TCP",
                                                                    "sourceAddresses": [
                                                                        "1.2.3.4"
                                                                    ],
                                                                    "destinationAddresses": [
                                                                        "5.6.7.8"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "transportSecurity": {
                                                        "certificateAuthority": {
                                                            "name": "clientcert",
                                                            "keyVaultSecretId": "https://kv/secret"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Is explicit proxy configured?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy?api-version=2024-03-01",
                                            "response": {
                                                "name": "firewallPolicy",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
                                                "type": "Microsoft.Network/firewallPolicies",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "size": "0.5MB",
                                                    "provisioningState": "Succeeded",
                                                    "threatIntelMode": "Alert",
                                                    "threatIntelWhitelist": {
                                                        "ipAddresses": [
                                                            "20.3.4.5"
                                                        ],
                                                        "fqdns": [
                                                            "*.microsoft.com"
                                                        ]
                                                    },
                                                    "ruleCollectionGroups": [
                                                        {
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
                                                        }
                                                    ],
                                                    "insights": {
                                                        "isEnabled": true,
                                                        "retentionDays": 100,
                                                        "logAnalyticsResources": {
                                                            "workspaces": [
                                                                {
                                                                    "region": "westus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace1"
                                                                    }
                                                                },
                                                                {
                                                                    "region": "eastus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace2"
                                                                    }
                                                                }
                                                            ],
                                                            "defaultWorkspaceId": {
                                                                "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/defaultWorkspace"
                                                            }
                                                        }
                                                    },
                                                    "firewalls": [],
                                                    "snat": {
                                                        "privateRanges": [
                                                            "IANAPrivateRanges"
                                                        ]
                                                    },
                                                    "sql": {
                                                        "allowSqlRedirect": true
                                                    },
                                                    "dnsSettings": {
                                                        "servers": [
                                                            "30.3.4.5"
                                                        ],
                                                        "enableProxy": true,
                                                        "requireProxyForNetworkRules": false
                                                    },
                                                    "explicitProxy": {
                                                        "enableExplicitProxy": true,
                                                        "httpPort": 8087,
                                                        "httpsPort": 8087,
                                                        "enablePacFile": true,
                                                        "pacFilePort": 8087,
                                                        "pacFile": "https://tinawstorage.file.core.windows.net/?sv=2020-02-10&ss=bfqt&srt=sco&sp=rwdlacuptfx&se=2021-06-04T07:01:12Z&st=2021-06-03T23:01:12Z&sip=68.65.171.11&spr=https&sig=Plsa0RRVpGbY0IETZZOT6znOHcSro71LLTTbzquYPgs%3D"
                                                    },
                                                    "sku": {
                                                        "tier": "Premium"
                                                    },
                                                    "intrusionDetection": {
                                                        "mode": "Alert",
                                                        "configuration": {
                                                            "signatureOverrides": [
                                                                {
                                                                    "id": "2525004",
                                                                    "mode": "Deny"
                                                                }
                                                            ],
                                                            "bypassTrafficSettings": [
                                                                {
                                                                    "name": "bypassRule1",
                                                                    "description": "Rule 1",
                                                                    "protocol": "TCP",
                                                                    "sourceAddresses": [
                                                                        "1.2.3.4"
                                                                    ],
                                                                    "destinationAddresses": [
                                                                        "5.6.7.8"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "transportSecurity": {
                                                        "certificateAuthority": {
                                                            "name": "clientcert",
                                                            "keyVaultSecretId": "https://kv/secret"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Is Firewall configured as a DNS proxy?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy?api-version=2024-03-01",
                                            "response": {
                                                "name": "firewallPolicy",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
                                                "type": "Microsoft.Network/firewallPolicies",
                                                "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
                                                "location": "West US",
                                                "tags": {
                                                    "key1": "value1"
                                                },
                                                "properties": {
                                                    "size": "0.5MB",
                                                    "provisioningState": "Succeeded",
                                                    "threatIntelMode": "Alert",
                                                    "threatIntelWhitelist": {
                                                        "ipAddresses": [
                                                            "20.3.4.5"
                                                        ],
                                                        "fqdns": [
                                                            "*.microsoft.com"
                                                        ]
                                                    },
                                                    "ruleCollectionGroups": [
                                                        {
                                                            "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
                                                        }
                                                    ],
                                                    "insights": {
                                                        "isEnabled": true,
                                                        "retentionDays": 100,
                                                        "logAnalyticsResources": {
                                                            "workspaces": [
                                                                {
                                                                    "region": "westus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace1"
                                                                    }
                                                                },
                                                                {
                                                                    "region": "eastus",
                                                                    "workspaceId": {
                                                                        "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/workspace2"
                                                                    }
                                                                }
                                                            ],
                                                            "defaultWorkspaceId": {
                                                                "id": "/subscriptions/subid/resourcegroups/rg1/providers/microsoft.operationalinsights/workspaces/defaultWorkspace"
                                                            }
                                                        }
                                                    },
                                                    "firewalls": [],
                                                    "snat": {
                                                        "privateRanges": [
                                                            "IANAPrivateRanges"
                                                        ]
                                                    },
                                                    "sql": {
                                                        "allowSqlRedirect": true
                                                    },
                                                    "dnsSettings": {
                                                        "servers": [
                                                            "30.3.4.5"
                                                        ],
                                                        "enableProxy": true,
                                                        "requireProxyForNetworkRules": false
                                                    },
                                                    "explicitProxy": {
                                                        "enableExplicitProxy": true,
                                                        "httpPort": 8087,
                                                        "httpsPort": 8087,
                                                        "enablePacFile": true,
                                                        "pacFilePort": 8087,
                                                        "pacFile": "https://tinawstorage.file.core.windows.net/?sv=2020-02-10&ss=bfqt&srt=sco&sp=rwdlacuptfx&se=2021-06-04T07:01:12Z&st=2021-06-03T23:01:12Z&sip=68.65.171.11&spr=https&sig=Plsa0RRVpGbY0IETZZOT6znOHcSro71LLTTbzquYPgs%3D"
                                                    },
                                                    "sku": {
                                                        "tier": "Premium"
                                                    },
                                                    "intrusionDetection": {
                                                        "mode": "Alert",
                                                        "configuration": {
                                                            "signatureOverrides": [
                                                                {
                                                                    "id": "2525004",
                                                                    "mode": "Deny"
                                                                }
                                                            ],
                                                            "bypassTrafficSettings": [
                                                                {
                                                                    "name": "bypassRule1",
                                                                    "description": "Rule 1",
                                                                    "protocol": "TCP",
                                                                    "sourceAddresses": [
                                                                        "1.2.3.4"
                                                                    ],
                                                                    "destinationAddresses": [
                                                                        "5.6.7.8"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "transportSecurity": {
                                                        "certificateAuthority": {
                                                            "name": "clientcert",
                                                            "keyVaultSecretId": "https://kv/secret"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    "default": {
                        "description": "Error response describing why the operation failed.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CloudError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "azure_auth": [
                            "https://management.azure.com/user_impersonation"
                        ]
                    }
                ]
            }
        },
        "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/firewallPolicies/{firewallPolicyName}/ruleCollectionGroups/{ruleCollectionGroupName}": {
            "get": {
                "summary": "Gets the specified FirewallPolicyRuleCollectionGroup",
                "description": "Retrieves details of a specified FirewallPolicyRuleCollectionGroup resource.",
                "operationId": "Intune_FirewallPolicyRuleCollectionGroup_Get",
                "parameters": [
                    {
                        "name": "subscriptionId",
                        "in": "path",
                        "description": "The subscription credentials that uniquely identify the Microsoft Azure subscription. This ID forms part of the URI for every service call.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "resourceGroupName",
                        "in": "path",
                        "description": "The name of the resource group.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "firewallPolicyName",
                        "in": "path",
                        "description": "The name of the Firewall Policy.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "ruleCollectionGroupName",
                        "in": "path",
                        "description": "The name of the FirewallPolicyRuleCollectionGroup.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [],
                            "x-enumDescriptions": {
                            }
                        }
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Client API version.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [ "2024-03-01" ],
                            "x-enumDescriptions": {
                                "2024-03-01": "The API version for March 2024."
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Request successful. The operation returns a FirewallPolicyRuleCollectionGroup resource.",
                        "content": {
                            "application/json": {
                                "type": "object",
                                "schema": {
                                    "$ref": "#/components/schemas/FirewallPolicyRuleCollectionGroup"
                                },
                                "examples": [
                                    {
                                        "summary": "Does the Firewall have a rule configured in rcgname to allow traffic from 2.2.2.2 to 152.23.32.23?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1?api-version=2024-03-01",
                                            "response": {
                                                "name": "ruleCollectionGroup1",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1",
                                                "etag": "W/\"72090554-7e3b-43f2-80ad-99a9020dcb11\"",
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "priority": 100,
                                                    "ruleCollections": [
                                                        {
                                                            "ruleCollectionType": "FirewallPolicyNatRuleCollection",
                                                            "action": {
                                                                "type": "DNAT"
                                                            },
                                                            "rules": [
                                                                {
                                                                    "ruleType": "NatRule",
                                                                    "name": "NatRule1",
                                                                    "translatedFqdn": "internalhttpserver",
                                                                    "translatedPort": "8080",
                                                                    "ipProtocols": [
                                                                        "TCP",
                                                                        "UDP"
                                                                    ],
                                                                    "sourceAddresses": [
                                                                        "2.2.2.2"
                                                                    ],
                                                                    "sourceIpGroups": [],
                                                                    "destinationAddresses": [
                                                                        "152.23.32.23"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "8080"
                                                                    ]
                                                                }
                                                            ],
                                                            "name": "NatRC",
                                                            "priority": 100
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What IP groups are being used in this RCG?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleGroup1?api-version=2024-03-01",
                                            "response": {
                                                "name": "ruleGroup1",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleGroups/ruleGroup1",
                                                "etag": "W/\"72090554-7e3b-43f2-80ad-99a9020dcb11\"",
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "priority": 110,
                                                    "ruleCollections": [
                                                        {
                                                            "ruleCollectionType": "FirewallPolicyFilterRuleCollection",
                                                            "name": "Example-Filter-Rule-Collection",
                                                            "priority": 200,
                                                            "action": {
                                                                "type": "Deny"
                                                            },
                                                            "rules": [
                                                                {
                                                                    "ruleType": "NetworkRule",
                                                                    "name": "network-rule1",
                                                                    "ipProtocols": [
                                                                        "TCP"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ],
                                                                    "sourceIpGroups": [
                                                                        "/subscriptions/subid/providers/Microsoft.Network/resourceGroup/rg1/ipGroups/ipGroups1"
                                                                    ],
                                                                    "destinationIpGroups": [
                                                                        "/subscriptions/subid/providers/Microsoft.Network/resourceGroup/rg1/ipGroups/ipGroups2"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "What are all the network rules in this RCG?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1?api-version=2024-03-01",
                                            "response": {
                                                "name": "ruleCollectionGroup1",
                                                "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1",
                                                "etag": "W/\"72090554-7e3b-43f2-80ad-99a9020dcb11\"",
                                                "properties": {
                                                    "size": "1.2MB",
                                                    "provisioningState": "Succeeded",
                                                    "priority": 110,
                                                    "ruleCollections": [
                                                        {
                                                            "ruleCollectionType": "FirewallPolicyFilterRuleCollection",
                                                            "name": "Example-Filter-Rule-Collection",
                                                            "priority": 200,
                                                            "action": {
                                                                "type": "Deny"
                                                            },
                                                            "rules": [
                                                                {
                                                                    "ruleType": "NetworkRule",
                                                                    "name": "network-rule1",
                                                                    "sourceAddresses": [
                                                                        "10.1.25.0/24"
                                                                    ],
                                                                    "destinationAddresses": [
                                                                        "*"
                                                                    ],
                                                                    "ipProtocols": [
                                                                        "TCP"
                                                                    ],
                                                                    "destinationPorts": [
                                                                        "*"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "summary": "Are there any web categories being blocked in this RCG?",
                                        "value": {
                                            "request": {},
                                            "requestUrl": "https://management.azure.com/subscriptions/e747cc13-97d4-4a79-b463-42d7f4e558f2/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1?api-version=2024-03-01",
                                            "response": {
                                                "name": "ruleCollectionGroup1",
                                                "id": "/subscriptions/e747cc13-97d4-4a79-b463-42d7f4e558f2/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1",
                                                "etag": "W/\"72090554-7e3b-43f2-80ad-99a9020dcb11\"",
                                                "properties": {
                                                    "provisioningState": "Succeeded",
                                                    "priority": 110,
                                                    "ruleCollections": [
                                                        {
                                                            "ruleCollectionType": "FirewallPolicyFilterRuleCollection",
                                                            "name": "Example-Filter-Rule-Collection",
                                                            "priority": 200,
                                                            "action": {
                                                                "type": "Deny"
                                                            },
                                                            "rules": [
                                                                {
                                                                    "ruleType": "ApplicationRule",
                                                                    "name": "rule1",
                                                                    "description": "Deny inbound rule",
                                                                    "protocols": [
                                                                        {
                                                                            "protocolType": "Https",
                                                                            "port": 443
                                                                        }
                                                                    ],
                                                                    "sourceAddresses": [
                                                                        "216.58.216.164",
                                                                        "10.0.0.0/24"
                                                                    ],
                                                                    "webCategories": [
                                                                        "Hacking"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    "default": {
                        "description": "Error response describing why the operation failed.",
                        "schema": {
                            "$ref": "#/components/schemas/CloudError"
                        }
                    }
                },
                "security": [
                    {
                        "azure_auth": [
                            "https://management.azure.com/user_impersonation"
                        ]
                    }
                ]
            }
        }
    },
    "components": {
        "securitySchemes": {
            "azure_auth": {
                "type": "oauth2",
                "flows": {
                    "implicit": {
                        "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
                        "scopes": {
                            "https://management.azure.com/user_impersonation": "impersonate your user account"
                        }
                    }
                }
            }
        },
        "schemas": {
            "AzureFirewall": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The name of the Azure Firewall."
                    },
                    "id": {
                        "type": "string",
                        "description": "Resource ID of the Azure Firewall."
                    },
                    "type": {
                        "type": "string",
                        "description": "Resource type."
                    },
                    "etag": {
                        "type": "string",
                        "description": "The etag of the Azure Firewall resource."
                    },
                    "location": {
                        "type": "string",
                        "description": "Location of the Azure Firewall."
                    },
                    "zones": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "tags": {
                        "type": "object",
                        "additionalProperties": {
                            "type": "string"
                        }
                    },
                    "properties": {
                        "type": "object",
                        "properties": {
                            "provisioningState": {
                                "type": "string",
                                "description": "Provisioning state of the Azure Firewall."
                            },
                            "sku": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "tier": {
                                        "type": "string"
                                    }
                                }
                            },
                            "threatIntelMode": {
                                "type": "string"
                            },
                            "ipConfigurations": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "id": {
                                            "type": "string"
                                        },
                                        "etag": {
                                            "type": "string"
                                        },
                                        "properties": {
                                            "type": "object",
                                            "properties": {
                                                "provisioningState": {
                                                    "type": "string"
                                                },
                                                "privateIPAddress": {
                                                    "type": "string"
                                                },
                                                "subnet": {
                                                    "type": "object",
                                                    "properties": {
                                                        "id": {
                                                            "type": "string"
                                                        }
                                                    }
                                                },
                                                "publicIPAddress": {
                                                    "type": "object",
                                                    "properties": {
                                                        "id": {
                                                            "type": "string"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "applicationRuleCollections": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "id": {
                                            "type": "string"
                                        },
                                        "properties": {
                                            "type": "object",
                                            "properties": {
                                                "priority": {
                                                    "type": "integer"
                                                },
                                                "action": {
                                                    "type": "object",
                                                    "properties": {
                                                        "type": {
                                                            "type": "string"
                                                        }
                                                    }
                                                },
                                                "rules": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "name": {
                                                                "type": "string"
                                                            },
                                                            "description": {
                                                                "type": "string"
                                                            },
                                                            "protocols": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "object",
                                                                    "properties": {
                                                                        "protocolType": {
                                                                            "type": "string"
                                                                        },
                                                                        "port": {
                                                                            "type": "integer"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "targetFqdns": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "sourceAddresses": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "natRuleCollections": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "id": {
                                            "type": "string"
                                        },
                                        "properties": {
                                            "type": "object",
                                            "properties": {
                                                "priority": {
                                                    "type": "integer"
                                                },
                                                "action": {
                                                    "type": "object",
                                                    "properties": {
                                                        "type": {
                                                            "type": "string"
                                                        }
                                                    }
                                                },
                                                "rules": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "name": {
                                                                "type": "string"
                                                            },
                                                            "description": {
                                                                "type": "string"
                                                            },
                                                            "sourceAddresses": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "destinationAddresses": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "destinationPorts": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "protocols": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "translatedAddress": {
                                                                "type": "string"
                                                            },
                                                            "translatedPort": {
                                                                "type": "string"
                                                            },
                                                            "translatedFqdn": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "networkRuleCollections": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "id": {
                                            "type": "string"
                                        },
                                        "properties": {
                                            "type": "object",
                                            "properties": {
                                                "priority": {
                                                    "type": "integer"
                                                },
                                                "action": {
                                                    "type": "object",
                                                    "properties": {
                                                        "type": {
                                                            "type": "string"
                                                        }
                                                    }
                                                },
                                                "rules": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "name": {
                                                                "type": "string"
                                                            },
                                                            "description": {
                                                                "type": "string"
                                                            },
                                                            "sourceAddresses": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "destinationPorts": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "destinationAddresses": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "protocols": {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": "string"
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "autoscaleConfiguration": {
                                "type": "object",
                                "properties": {
                                    "minCapacity": {
                                        "type": "integer"
                                    },
                                    "maxCapacity": {
                                        "type": "integer"
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "FirewallPolicy": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The name of the Firewall Policy."
                    },
                    "id": {
                        "type": "string",
                        "description": "Resource ID of the Firewall Policy."
                    },
                    "type": {
                        "type": "string",
                        "description": "Resource type."
                    },
                    "etag": {
                        "type": "string",
                        "description": "The etag of the Firewall Policy resource."
                    },
                    "location": {
                        "type": "string",
                        "description": "Location of the Firewall Policy."
                    },
                    "tags": {
                        "type": "object",
                        "additionalProperties": {
                            "type": "string"
                        },
                        "description": "Resource tags."
                    },
                    "properties": {
                        "type": "object",
                        "properties": {
                            "size": {
                                "type": "string",
                                "description": "The size of the Firewall Policy."
                            },
                            "provisioningState": {
                                "type": "string",
                                "description": "Provisioning state of the Firewall Policy."
                            },
                            "threatIntelMode": {
                                "type": "string",
                                "description": "Threat Intelligence mode for the Firewall Policy."
                            },
                            "threatIntelWhitelist": {
                                "type": "object",
                                "properties": {
                                    "ipAddresses": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "IP addresses in the whitelist."
                                    },
                                    "fqdns": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "FQDNs in the whitelist."
                                    }
                                }
                            },
                            "ruleCollectionGroups": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "id": {
                                            "type": "string",
                                            "description": "Resource ID of the Rule Collection Group."
                                        }
                                    }
                                }
                            },
                            "insights": {
                                "type": "object",
                                "properties": {
                                    "isEnabled": {
                                        "type": "boolean",
                                        "description": "Indicates if insights are enabled."
                                    },
                                    "retentionDays": {
                                        "type": "integer",
                                        "description": "Retention days for insights data."
                                    },
                                    "logAnalyticsResources": {
                                        "type": "object",
                                        "properties": {
                                            "workspaces": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "region": {
                                                            "type": "string",
                                                            "description": "Region of the workspace."
                                                        },
                                                        "workspaceId": {
                                                            "type": "object",
                                                            "properties": {
                                                                "id": {
                                                                    "type": "string",
                                                                    "description": "Resource ID of the workspace."
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "defaultWorkspaceId": {
                                                "type": "object",
                                                "properties": {
                                                    "id": {
                                                        "type": "string",
                                                        "description": "Resource ID of the default workspace."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "firewalls": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "description": "List of firewalls associated with the policy."
                            },
                            "snat": {
                                "type": "object",
                                "properties": {
                                    "privateRanges": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Private IP address ranges for SNAT."
                                    }
                                }
                            },
                            "sql": {
                                "type": "object",
                                "properties": {
                                    "allowSqlRedirect": {
                                        "type": "boolean",
                                        "description": "Allow SQL redirect for the Firewall Policy."
                                    }
                                }
                            },
                            "dnsSettings": {
                                "type": "object",
                                "properties": {
                                    "servers": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "DNS servers used by the Firewall Policy."
                                    },
                                    "enableProxy": {
                                        "type": "boolean",
                                        "description": "Enable proxy for DNS settings."
                                    },
                                    "requireProxyForNetworkRules": {
                                        "type": "boolean",
                                        "description": "Require proxy for network rules."
                                    }
                                }
                            },
                            "explicitProxy": {
                                "type": "object",
                                "properties": {
                                    "enableExplicitProxy": {
                                        "type": "boolean",
                                        "description": "Enable explicit proxy for the Firewall Policy."
                                    },
                                    "httpPort": {
                                        "type": "integer",
                                        "description": "HTTP port for explicit proxy."
                                    },
                                    "httpsPort": {
                                        "type": "integer",
                                        "description": "HTTPS port for explicit proxy."
                                    },
                                    "enablePacFile": {
                                        "type": "boolean",
                                        "description": "Enable PAC file for the explicit proxy."
                                    },
                                    "pacFilePort": {
                                        "type": "integer",
                                        "description": "PAC file port for the explicit proxy."
                                    },
                                    "pacFile": {
                                        "type": "string",
                                        "description": "PAC file URL for the explicit proxy."
                                    }
                                }
                            },
                            "sku": {
                                "type": "object",
                                "properties": {
                                    "tier": {
                                        "type": "string",
                                        "description": "Tier of the Firewall Policy SKU."
                                    }
                                }
                            },
                            "intrusionDetection": {
                                "type": "object",
                                "properties": {
                                    "mode": {
                                        "type": "string",
                                        "description": "Intrusion detection mode for the Firewall Policy."
                                    },
                                    "configuration": {
                                        "type": "object",
                                        "properties": {
                                            "signatureOverrides": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "id": {
                                                            "type": "string",
                                                            "description": "ID of the signature."
                                                        },
                                                        "mode": {
                                                            "type": "string",
                                                            "description": "Mode for the signature."
                                                        }
                                                    }
                                                }
                                            },
                                            "bypassTrafficSettings": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "name": {
                                                            "type": "string",
                                                            "description": "Name of the bypass rule."
                                                        },
                                                        "description": {
                                                            "type": "string",
                                                            "description": "Description of the bypass rule."
                                                        },
                                                        "protocol": {
                                                            "type": "string",
                                                            "description": "Protocol for the bypass rule."
                                                        },
                                                        "sourceAddresses": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "string"
                                                            },
                                                            "description": "Source addresses for the bypass rule."
                                                        },
                                                        "destinationAddresses": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "string"
                                                            },
                                                            "description": "Destination addresses for the bypass rule."
                                                        },
                                                        "destinationPorts": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "string"
                                                            },
                                                            "description": "Destination ports for the bypass rule."
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "transportSecurity": {
                                "type": "object",
                                "properties": {
                                    "certificateAuthority": {
                                        "type": "object",
                                        "properties": {
                                            "name": {
                                                "type": "string",
                                                "description": "Name of the certificate authority."
                                            },
                                            "keyVaultSecretId": {
                                                "type": "string",
                                                "description": "Key Vault secret ID for the certificate authority."
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "FirewallPolicyRuleCollectionGroup": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The name of the rule collection group."
                    },
                    "id": {
                        "type": "string",
                        "description": "Resource ID of the rule collection group."
                    },
                    "etag": {
                        "type": "string",
                        "description": "The etag of the rule collection group."
                    },
                    "properties": {
                        "type": "object",
                        "properties": {
                            "provisioningState": {
                                "type": "string",
                                "description": "Provisioning state of the rule collection group."
                            },
                            "size": {
                                "type": "string",
                                "description": "The size of the rule collection group, if available."
                            },
                            "priority": {
                                "type": "integer",
                                "description": "Priority of the rule collection group."
                            },
                            "ruleCollections": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "ruleCollectionType": {
                                            "type": "string",
                                            "description": "Type of the rule collection (e.g., FirewallPolicyNatRuleCollection or FirewallPolicyFilterRuleCollection)."
                                        },
                                        "name": {
                                            "type": "string",
                                            "description": "The name of the rule collection."
                                        },
                                        "priority": {
                                            "type": "integer",
                                            "description": "Priority of the rule collection."
                                        },
                                        "action": {
                                            "type": "object",
                                            "properties": {
                                                "type": {
                                                    "type": "string",
                                                    "description": "Action type (e.g., DNAT or Deny)."
                                                }
                                            }
                                        },
                                        "rules": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "ruleType": {
                                                        "type": "string",
                                                        "description": "Type of the rule (e.g., NatRule or NetworkRule)."
                                                    },
                                                    "name": {
                                                        "type": "string",
                                                        "description": "Name of the rule."
                                                    },
                                                    "translatedFqdn": {
                                                        "type": "string",
                                                        "description": "The translated FQDN for NatRule type rules, if available."
                                                    },
                                                    "translatedPort": {
                                                        "type": "string",
                                                        "description": "The translated port for NatRule type rules, if available."
                                                    },
                                                    "ipProtocols": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "IP protocols for the rule."
                                                    },
                                                    "sourceAddresses": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "Source addresses for the rule."
                                                    },
                                                    "sourceIpGroups": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "Source IP groups for the rule."
                                                    },
                                                    "destinationAddresses": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "Destination addresses for the rule."
                                                    },
                                                    "destinationPorts": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "Destination ports for the rule."
                                                    },
                                                    "destinationIpGroups": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "description": "Destination IP groups for the rule, if available."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "CloudError": {
                "type": "object",
                "properties": {
                    "error": {
                        "type": "object",
                        "properties": {
                            "code": {
                                "type": "string"
                            },
                            "message": {
                                "type": "string"
                            },
                            "target": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        }
    }
}
